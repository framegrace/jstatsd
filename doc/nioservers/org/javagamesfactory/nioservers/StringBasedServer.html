<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_03) on Sun Jan 20 23:04:34 GMT 2008 -->
<TITLE>
StringBasedServer
</TITLE>

<META NAME="date" CONTENT="2008-01-20">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="StringBasedServer";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../org/javagamesfactory/nioservers/package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/StringBasedServer.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../org/javagamesfactory/nioservers/StringBasedClient.html" title="class in org.javagamesfactory.nioservers"><B>PREV CLASS</B></A>&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?org/javagamesfactory/nioservers/StringBasedServer.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="StringBasedServer.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.javagamesfactory.nioservers</FONT>
<BR>
Class StringBasedServer</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>org.javagamesfactory.nioservers.StringBasedServer</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD>java.lang.Runnable</DD>
</DL>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../../org/javagamesfactory/nioservers/SimpleServerDemo.html" title="class in org.javagamesfactory.nioservers">SimpleServerDemo</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public abstract class <B>StringBasedServer</B><DT>extends java.lang.Object<DT>implements java.lang.Runnable</DL>
</PRE>

<P>
Base class that provides the core of a non-blocking NIO-driven server which can send and receive
 Strings seamlessly. It correctly handles partial/fragmented incoming and outgoing packets, etc.
 <P>
 There are two methods in this class you need to override when subclassing. The first is
 keyCancelled which you MUST override, or else you will get data-errors / crashes because your
 data structures will become corrupted whenever a user disconnects.
 <P>
 The second is processStringMessage, which is where all the incoming messages get sent to, and is
 the primary way for you to respond to incoming messages / requests / etc.
 <P>
 There is a second Logger instance in this class, mapped to [classname].verbose, which gives VERY
 verbose information when you put it into info or debug Level.
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#processStringMessage(java.lang.String, java.nio.channels.SelectionKey)"><CODE>processStringMessage(String, SelectionKey)</CODE></A>, 
<A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#keyCancelled(java.nio.channels.SelectionKey)"><CODE>keyCancelled(SelectionKey)</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.LinkedList&lt;java.nio.channels.SocketChannel&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#connectedChannels">connectedChannels</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#defaultByteBufferSize">defaultByteBufferSize</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default size to create ALL incoming and outgoing buffers; this equates to the maximum size of
 message that can be sent or received.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;org.apache.log4j.Logger</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#logger">logger</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap&lt;java.nio.channels.SelectionKey,java.lang.Integer&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#messageLengths">messageLengths</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../org/javagamesfactory/nioservers/iServerInfo.html" title="interface in org.javagamesfactory.nioservers">iServerInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#myInfo">myInfo</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap&lt;java.nio.channels.SelectionKey,java.util.LinkedList&lt;java.nio.ByteBuffer&gt;&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#pendingOutgoingEncodedMessages">pendingOutgoingEncodedMessages</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap&lt;java.nio.channels.SelectionKey,java.util.LinkedList&lt;java.lang.String&gt;&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#pendingOutgoingMessages">pendingOutgoingMessages</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#port">port</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap&lt;java.nio.channels.SelectionKey,java.lang.Boolean&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#readBufferIsEmpty">readBufferIsEmpty</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap&lt;java.nio.channels.SelectionKey,java.nio.ByteBuffer&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#readByteBuffers">readByteBuffers</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap&lt;java.nio.channels.SelectionKey,java.nio.CharBuffer&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#readCharBuffers">readCharBuffers</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.nio.channels.Selector</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#selector">selector</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../org/javagamesfactory/nioservers/ServerState.html" title="enum in org.javagamesfactory.nioservers">ServerState</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#status">status</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#targetPort">targetPort</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;org.apache.log4j.Logger</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#verboseLogger">verboseLogger</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap&lt;java.nio.channels.SelectionKey,java.nio.ByteBuffer&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#writeByteBuffers">writeByteBuffers</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#StringBasedServer(int)">StringBasedServer</A></B>(int&nbsp;p)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a server using the default byte buffer size</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#StringBasedServer(int, int)">StringBasedServer</A></B>(int&nbsp;p,
                  int&nbsp;newBufferSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a server with a custom byte-buffer size, and ignores the defaultByteBufferSize</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#addErrorToKey(java.nio.channels.SelectionKey, java.lang.String, java.lang.String)">addErrorToKey</A></B>(java.nio.channels.SelectionKey&nbsp;key,
              java.lang.String&nbsp;originalMessage,
              java.lang.String&nbsp;errorDescription)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convenience method for sending error messages to a client using simple XML format to easily extract
 what went wrong and what caused the error</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#addMessageToKey(java.nio.channels.SelectionKey, java.lang.String)">addMessageToKey</A></B>(java.nio.channels.SelectionKey&nbsp;key,
                java.lang.String&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Primary means of sending a message to a particular client; subclasses should use this
 method for ALL outgoing messages</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#debug(java.lang.String)">debug</A></B>(java.lang.String&nbsp;s)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Works out the thread and port and prepends them to the log message before logging it to the
 standard logger</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#debugVerbose(java.lang.String)">debugVerbose</A></B>(java.lang.String&nbsp;s)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Works out the thread and port and prepends them to the log message before logging it to the
 standard logger</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#error(java.lang.String)">error</A></B>(java.lang.String&nbsp;s)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Works out the thread and port and prepends them to the log message before logging it to the
 standard logger</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#error(java.lang.String, java.lang.Throwable)">error</A></B>(java.lang.String&nbsp;s,
      java.lang.Throwable&nbsp;t)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Works out the thread and port and prepends them to the log message before logging it to the
 standard logger</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#getNumberOfConnectedChannels()">getNumberOfConnectedChannels</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This class keeps track of how many channels are currently connected, adding them
 every time a key is accepted, and removing them as soon as there is an I/O error
 or READ or WRITE</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#getPort()">getPort</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The port that this server is bound to</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../org/javagamesfactory/nioservers/ServerState.html" title="enum in org.javagamesfactory.nioservers">ServerState</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#getStatus()">getStatus</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The status variable tells you exactly what the internal state-machine of the server is currently
 doing (or trying to do)</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#info(java.lang.String)">info</A></B>(java.lang.String&nbsp;s)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Works out the thread and port and prepends them to the log message before logging it to the
 standard logger</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#info(java.lang.String, java.lang.Throwable)">info</A></B>(java.lang.String&nbsp;s,
     java.lang.Throwable&nbsp;t)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Works out the thread and port and prepends them to the log message before logging it to the
 standard logger</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#infoVerbose(java.lang.String)">infoVerbose</A></B>(java.lang.String&nbsp;s)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Works out the thread and port and prepends them to the log message before logging it to the
 standard logger</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected abstract &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#keyCancelled(java.nio.channels.SelectionKey)">keyCancelled</A></B>(java.nio.channels.SelectionKey&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subclasses MUST override this method to remove data from local data structures whenever
 connections are dropped / closed</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#peekOutgoingMessageQueueForKey(java.nio.channels.SelectionKey)">peekOutgoingMessageQueueForKey</A></B>(java.nio.channels.SelectionKey&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Allows you to have a look at what is due to be sent to any given client, but hasn't
 yet been sent - automatically keeps track of the message in non-bytes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected abstract &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#postSelect(long)">postSelect</A></B>(long&nbsp;millisecondsSinceLastStarted)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoked every time a select completes, IRRESPECTIVE of whether there was any network data.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected abstract &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#processStringMessage(java.lang.String, java.nio.channels.SelectionKey)">processStringMessage</A></B>(java.lang.String&nbsp;message,
                     java.nio.channels.SelectionKey&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subclasses SHOULD override this method to process all incoming messages</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#readIncomingMessageFromKey(java.nio.channels.SelectionKey)">readIncomingMessageFromKey</A></B>(java.nio.channels.SelectionKey&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An intelligent read-from-bytebuffer-into-string method that seamlessly copes with
 partial reads.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#run()">run</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Core of the server; this method runs continuously once the server has started, and continues until
 a successful call is made to the stop method</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#start()">start</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Starts the server; must be called or else the server won't do anything.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#stop()">stop</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stops the server - not immediately (attempts immediate stop, but the server will have to finish
 some processing and close down some native OS resources, which takes time)</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="defaultByteBufferSize"><!-- --></A><H3>
defaultByteBufferSize</H3>
<PRE>
public static int <B>defaultByteBufferSize</B></PRE>
<DL>
<DD>Default size to create ALL incoming and outgoing buffers; this equates to the maximum size of
 message that can be sent or received.
 <P>
 NB: this variable is ONLY checked at construction time; you must alter it BEFORE constructing
 an instance of a server if you want it to have effect (or use the alternative constructor that
 allows you to specify a custom value for that instance only).
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="logger"><!-- --></A><H3>
logger</H3>
<PRE>
protected org.apache.log4j.Logger <B>logger</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="verboseLogger"><!-- --></A><H3>
verboseLogger</H3>
<PRE>
protected org.apache.log4j.Logger <B>verboseLogger</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="status"><!-- --></A><H3>
status</H3>
<PRE>
protected <A HREF="../../../org/javagamesfactory/nioservers/ServerState.html" title="enum in org.javagamesfactory.nioservers">ServerState</A> <B>status</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="selector"><!-- --></A><H3>
selector</H3>
<PRE>
protected java.nio.channels.Selector <B>selector</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="readByteBuffers"><!-- --></A><H3>
readByteBuffers</H3>
<PRE>
protected java.util.HashMap&lt;java.nio.channels.SelectionKey,java.nio.ByteBuffer&gt; <B>readByteBuffers</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="readCharBuffers"><!-- --></A><H3>
readCharBuffers</H3>
<PRE>
protected java.util.HashMap&lt;java.nio.channels.SelectionKey,java.nio.CharBuffer&gt; <B>readCharBuffers</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="messageLengths"><!-- --></A><H3>
messageLengths</H3>
<PRE>
protected java.util.HashMap&lt;java.nio.channels.SelectionKey,java.lang.Integer&gt; <B>messageLengths</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="writeByteBuffers"><!-- --></A><H3>
writeByteBuffers</H3>
<PRE>
protected java.util.HashMap&lt;java.nio.channels.SelectionKey,java.nio.ByteBuffer&gt; <B>writeByteBuffers</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="pendingOutgoingMessages"><!-- --></A><H3>
pendingOutgoingMessages</H3>
<PRE>
protected java.util.HashMap&lt;java.nio.channels.SelectionKey,java.util.LinkedList&lt;java.lang.String&gt;&gt; <B>pendingOutgoingMessages</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="pendingOutgoingEncodedMessages"><!-- --></A><H3>
pendingOutgoingEncodedMessages</H3>
<PRE>
protected java.util.HashMap&lt;java.nio.channels.SelectionKey,java.util.LinkedList&lt;java.nio.ByteBuffer&gt;&gt; <B>pendingOutgoingEncodedMessages</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="readBufferIsEmpty"><!-- --></A><H3>
readBufferIsEmpty</H3>
<PRE>
protected java.util.HashMap&lt;java.nio.channels.SelectionKey,java.lang.Boolean&gt; <B>readBufferIsEmpty</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="port"><!-- --></A><H3>
port</H3>
<PRE>
protected int <B>port</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="targetPort"><!-- --></A><H3>
targetPort</H3>
<PRE>
protected int <B>targetPort</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="myInfo"><!-- --></A><H3>
myInfo</H3>
<PRE>
protected <A HREF="../../../org/javagamesfactory/nioservers/iServerInfo.html" title="interface in org.javagamesfactory.nioservers">iServerInfo</A> <B>myInfo</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="connectedChannels"><!-- --></A><H3>
connectedChannels</H3>
<PRE>
protected java.util.LinkedList&lt;java.nio.channels.SocketChannel&gt; <B>connectedChannels</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="StringBasedServer(int)"><!-- --></A><H3>
StringBasedServer</H3>
<PRE>
public <B>StringBasedServer</B>(int&nbsp;p)
                  throws java.net.UnknownHostException</PRE>
<DL>
<DD>Creates a server using the default byte buffer size
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>p</CODE> - port which this server should bind to
<DT><B>Throws:</B>
<DD><CODE>java.net.UnknownHostException</CODE><DT><B>See Also:</B><DD><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#defaultByteBufferSize"><CODE>defaultByteBufferSize</CODE></A></DL>
</DL>
<HR>

<A NAME="StringBasedServer(int, int)"><!-- --></A><H3>
StringBasedServer</H3>
<PRE>
public <B>StringBasedServer</B>(int&nbsp;p,
                         int&nbsp;newBufferSize)
                  throws java.net.UnknownHostException</PRE>
<DL>
<DD>Creates a server with a custom byte-buffer size, and ignores the defaultByteBufferSize
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>p</CODE> - port which this server should bind to<DD><CODE>newBufferSize</CODE> - sets the size of all receive and send buffers, overriding the defaultByteBufferSize
<DT><B>Throws:</B>
<DD><CODE>java.net.UnknownHostException</CODE><DT><B>See Also:</B><DD><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#defaultByteBufferSize"><CODE>defaultByteBufferSize</CODE></A></DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="processStringMessage(java.lang.String, java.nio.channels.SelectionKey)"><!-- --></A><H3>
processStringMessage</H3>
<PRE>
protected abstract void <B>processStringMessage</B>(java.lang.String&nbsp;message,
                                             java.nio.channels.SelectionKey&nbsp;key)
                                      throws java.nio.channels.ClosedChannelException</PRE>
<DL>
<DD>Subclasses SHOULD override this method to process all incoming messages
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.nio.channels.ClosedChannelException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="keyCancelled(java.nio.channels.SelectionKey)"><!-- --></A><H3>
keyCancelled</H3>
<PRE>
protected abstract void <B>keyCancelled</B>(java.nio.channels.SelectionKey&nbsp;key)</PRE>
<DL>
<DD>Subclasses MUST override this method to remove data from local data structures whenever
 connections are dropped / closed
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="run()"><!-- --></A><H3>
run</H3>
<PRE>
public void <B>run</B>()</PRE>
<DL>
<DD>Core of the server; this method runs continuously once the server has started, and continues until
 a successful call is made to the stop method
 <P>
 You can check if this method is running by inspecting the status variable - if it is RUNNING, then
 this method is happily chugging away
 <P>
 This server is single-threaded, using a single NIO Selector to do all the work of accepting, reading
 from and writing to connected TCP channels.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>run</CODE> in interface <CODE>java.lang.Runnable</CODE></DL>
</DD>
<DD><DL>
<DT><B>See Also:</B><DD><A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#start()"><CODE>start()</CODE></A>, 
<A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#stop()"><CODE>stop()</CODE></A>, 
<A HREF="../../../org/javagamesfactory/nioservers/StringBasedServer.html#getStatus()"><CODE>getStatus()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="postSelect(long)"><!-- --></A><H3>
postSelect</H3>
<PRE>
protected abstract void <B>postSelect</B>(long&nbsp;millisecondsSinceLastStarted)</PRE>
<DL>
<DD>Invoked every time a select completes, IRRESPECTIVE of whether there was any network data.
 <P>
 This is primarily useful for servers that wish to be purely singlethreaded and do all their
 local processing in the gap between performing successive selects (lets you avoid using
 synchronized blocks anywhere)
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>millisecondsSinceLastStarted</CODE> - the number of milliseconds since this method was last
           called; i.e. the time at which it was INVOKED, not the time at which it RETURNED;
           this is perfect for maintaining fixed-rate game loops</DL>
</DD>
</DL>
<HR>

<A NAME="getNumberOfConnectedChannels()"><!-- --></A><H3>
getNumberOfConnectedChannels</H3>
<PRE>
protected int <B>getNumberOfConnectedChannels</B>()</PRE>
<DL>
<DD>This class keeps track of how many channels are currently connected, adding them
 every time a key is accepted, and removing them as soon as there is an I/O error
 or READ or WRITE
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>number of currently connected channels - may be slightly incorrect (gets
 updated only after each select operation takes place)</DL>
</DD>
</DL>
<HR>

<A NAME="addMessageToKey(java.nio.channels.SelectionKey, java.lang.String)"><!-- --></A><H3>
addMessageToKey</H3>
<PRE>
protected void <B>addMessageToKey</B>(java.nio.channels.SelectionKey&nbsp;key,
                               java.lang.String&nbsp;message)
                        throws java.nio.channels.ClosedChannelException</PRE>
<DL>
<DD>Primary means of sending a message to a particular client; subclasses should use this
 method for ALL outgoing messages
 <P>
 NB: this method is NOT as efficient as it could be - it neither recycles buffers, nor
 does it intelligently create them of variable size. All buffers are created at a single
 fixed size (default 2000 bytes), configurable by changing the byteBufferSize variable.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - the key representing the client to send to<DD><CODE>message</CODE> - the message to send
<DT><B>Throws:</B>
<DD><CODE>java.nio.channels.ClosedChannelException</CODE> - if the client is no longer connected</DL>
</DD>
</DL>
<HR>

<A NAME="peekOutgoingMessageQueueForKey(java.nio.channels.SelectionKey)"><!-- --></A><H3>
peekOutgoingMessageQueueForKey</H3>
<PRE>
protected java.lang.String <B>peekOutgoingMessageQueueForKey</B>(java.nio.channels.SelectionKey&nbsp;key)</PRE>
<DL>
<DD>Allows you to have a look at what is due to be sent to any given client, but hasn't
 yet been sent - automatically keeps track of the message in non-bytes.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - client to peek at
<DT><B>Returns:</B><DD></DL>
</DD>
</DL>
<HR>

<A NAME="addErrorToKey(java.nio.channels.SelectionKey, java.lang.String, java.lang.String)"><!-- --></A><H3>
addErrorToKey</H3>
<PRE>
protected void <B>addErrorToKey</B>(java.nio.channels.SelectionKey&nbsp;key,
                             java.lang.String&nbsp;originalMessage,
                             java.lang.String&nbsp;errorDescription)
                      throws java.nio.channels.ClosedChannelException</PRE>
<DL>
<DD>Convenience method for sending error messages to a client using simple XML format to easily extract
 what went wrong and what caused the error
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - client to send to<DD><CODE>originalMessage</CODE> - the message that you received from the client that caused the error<DD><CODE>errorDescription</CODE> - human-readable description of the error
<DT><B>Throws:</B>
<DD><CODE>java.nio.channels.ClosedChannelException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="start()"><!-- --></A><H3>
start</H3>
<PRE>
public void <B>start</B>()</PRE>
<DL>
<DD>Starts the server; must be called or else the server won't do anything.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="stop()"><!-- --></A><H3>
stop</H3>
<PRE>
public void <B>stop</B>()</PRE>
<DL>
<DD>Stops the server - not immediately (attempts immediate stop, but the server will have to finish
 some processing and close down some native OS resources, which takes time)
 <P>
 NB: there are MANY stages to stopping the server (this method is over 50 lines of code already)
 to handle all the edge cases of parts of the server crashing while trying to stop. Be patient!
 Worst-case scenario, an inner loop pauses for 10 milliseconds and re-checks to see if it can
 terminate the server yet - but if this waiting happens, it will output INFO messages to warn
 you that it hasn't hung, it's just trying to shutdown and failing. 
 <P>
 NOTE: uses custom logger calls because the notion of which thread it the server is running in
 is less obvious inside this method!
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getStatus()"><!-- --></A><H3>
getStatus</H3>
<PRE>
public <A HREF="../../../org/javagamesfactory/nioservers/ServerState.html" title="enum in org.javagamesfactory.nioservers">ServerState</A> <B>getStatus</B>()</PRE>
<DL>
<DD>The status variable tells you exactly what the internal state-machine of the server is currently
 doing (or trying to do)
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>current status of the server<DT><B>See Also:</B><DD><A HREF="../../../org/javagamesfactory/nioservers/ServerState.html" title="enum in org.javagamesfactory.nioservers"><CODE>ServerState</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="readIncomingMessageFromKey(java.nio.channels.SelectionKey)"><!-- --></A><H3>
readIncomingMessageFromKey</H3>
<PRE>
protected java.lang.String <B>readIncomingMessageFromKey</B>(java.nio.channels.SelectionKey&nbsp;key)
                                               throws java.io.IOException</PRE>
<DL>
<DD>An intelligent read-from-bytebuffer-into-string method that seamlessly copes with
 partial reads.
 
 NB: this server REQUIRES that all incoming messages to be preceded by a single int saying how many
 bytes are in the message, and assumes that you are using a 1-byte wide charset (i.e. it
 doesn't track number of bytes separately from number of chars - it will NOT WORK if you use
 multi-byte charsets!)
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - 
<DT><B>Returns:</B><DD>null if the message is incomplete, the complete message otherwise
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPort()"><!-- --></A><H3>
getPort</H3>
<PRE>
public int <B>getPort</B>()</PRE>
<DL>
<DD>The port that this server is bound to
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the port that this server is bound to, or -1 if not yet bound successfully</DL>
</DD>
</DL>
<HR>

<A NAME="debug(java.lang.String)"><!-- --></A><H3>
debug</H3>
<PRE>
protected void <B>debug</B>(java.lang.String&nbsp;s)</PRE>
<DL>
<DD>Works out the thread and port and prepends them to the log message before logging it to the
 standard logger
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>s</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="debugVerbose(java.lang.String)"><!-- --></A><H3>
debugVerbose</H3>
<PRE>
protected void <B>debugVerbose</B>(java.lang.String&nbsp;s)</PRE>
<DL>
<DD>Works out the thread and port and prepends them to the log message before logging it to the
 standard logger
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>s</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="info(java.lang.String)"><!-- --></A><H3>
info</H3>
<PRE>
protected void <B>info</B>(java.lang.String&nbsp;s)</PRE>
<DL>
<DD>Works out the thread and port and prepends them to the log message before logging it to the
 standard logger
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>s</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="infoVerbose(java.lang.String)"><!-- --></A><H3>
infoVerbose</H3>
<PRE>
protected void <B>infoVerbose</B>(java.lang.String&nbsp;s)</PRE>
<DL>
<DD>Works out the thread and port and prepends them to the log message before logging it to the
 standard logger
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>s</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="info(java.lang.String, java.lang.Throwable)"><!-- --></A><H3>
info</H3>
<PRE>
protected void <B>info</B>(java.lang.String&nbsp;s,
                    java.lang.Throwable&nbsp;t)</PRE>
<DL>
<DD>Works out the thread and port and prepends them to the log message before logging it to the
 standard logger
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>s</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="error(java.lang.String)"><!-- --></A><H3>
error</H3>
<PRE>
protected void <B>error</B>(java.lang.String&nbsp;s)</PRE>
<DL>
<DD>Works out the thread and port and prepends them to the log message before logging it to the
 standard logger
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>s</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="error(java.lang.String, java.lang.Throwable)"><!-- --></A><H3>
error</H3>
<PRE>
protected void <B>error</B>(java.lang.String&nbsp;s,
                     java.lang.Throwable&nbsp;t)</PRE>
<DL>
<DD>Works out the thread and port and prepends them to the log message before logging it to the
 standard logger
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>s</CODE> - </DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../org/javagamesfactory/nioservers/package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/StringBasedServer.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../org/javagamesfactory/nioservers/StringBasedClient.html" title="class in org.javagamesfactory.nioservers"><B>PREV CLASS</B></A>&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?org/javagamesfactory/nioservers/StringBasedServer.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="StringBasedServer.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
